/* Sidebar/Drawer Component
 * Responsive sidebar with overlay, push, resizable, and collapsible modes
 */

.c-sidebar {
	--sidebar-width: 16rem;
	--sidebar-min-width: 12rem;
	--sidebar-max-width: 24rem;
	--sidebar-transition: transform 0.3s ease-in-out;

	position: fixed;
	top: 0;
	bottom: 0;
	width: var(--sidebar-width);
	min-width: var(--sidebar-min-width);
	max-width: var(--sidebar-max-width);
	display: flex;
	flex-direction: column;
	z-index: 100;
	transition: var(--sidebar-transition);
	overflow: hidden;

	/* Color system */
	--col-bg: var(--col-container-low);
	--col-on: var(--col-on-container-low);
	--col-em: var(--col-em-container-low);
	background-color: lch(from var(--col-bg) l c h / var(--op-panel));
	backdrop-filter: blur(var(--blur-radius));
	color: var(--col-on);
	border-right: var(--border-w-lg) solid var(--col-outline);

	&.left {
		left: 0;
		transform: translateX(calc(-1 * var(--sidebar-width)));
	}

	&.right {
		right: 0;
		border-right: none;
		border-left: var(--border-w-lg) solid var(--col-outline);
		transform: translateX(var(--sidebar-width));
	}

	/* Open state */
	&.open {
		transform: translateX(0);
	}

	/* Pinned state (desktop: push content mode) */
	&.pinned {
		transform: translateX(0);
	}

	/* Elevation modifiers */
	&.low {
		--col-bg: var(--col-container-low);
		--col-on: var(--col-on-container-low);
		--col-em: var(--col-em-container-low);
	}
	&.mid {
		--col-bg: var(--col-container);
		--col-on: var(--col-on-container);
		--col-em: var(--col-em-container);
	}
	&.high {
		--col-bg: var(--col-container-high);
		--col-on: var(--col-on-container-high);
		--col-em: var(--col-em-container-high);
	}

	/* Color modifiers */
	&.primary {
		--col-bg: var(--col-container-primary);
		--col-on: var(--col-on-container-primary);
		--col-em: var(--col-em-container-primary);
	}
	&.secondary {
		--col-bg: var(--col-container-secondary);
		--col-on: var(--col-on-container-secondary);
		--col-em: var(--col-em-container-secondary);
	}
	&.accent {
		--col-bg: var(--col-container-accent);
		--col-on: var(--col-on-container-accent);
		--col-em: var(--col-em-container-accent);
	}
	&.error {
		--col-bg: var(--col-container-error);
		--col-on: var(--col-on-container-error);
		--col-em: var(--col-em-container-error);
	}
	&.warning {
		--col-bg: var(--col-container-warning);
		--col-on: var(--col-on-container-warning);
		--col-em: var(--col-em-container-warning);
	}
	&.success {
		--col-bg: var(--col-container-success);
		--col-on: var(--col-on-container-success);
		--col-em: var(--col-em-container-success);
	}
}

/* Sidebar content area */
.c-sidebar-content {
	flex: 1;
	overflow-y: auto;
	overflow-x: hidden;
	padding: var(--p-panel);
}

/* Resize handle */
.c-sidebar-resize-handle {
	position: absolute;
	top: 0;
	bottom: 0;
	width: 0.25rem;
	cursor: ew-resize;
	background: transparent;
	transition: background 0.2s;
	z-index: 10;

	.c-sidebar.left & {
		right: 0;
	}

	.c-sidebar.right & {
		left: 0;
	}

	&:hover,
	&:active {
		background: var(--col-primary);
	}
}

/* Resizing state */
.c-sidebar.resizing {
	transition: none;
	user-select: none;

	& .c-sidebar-resize-handle {
		background: var(--col-primary);
	}
}

/* Backdrop overlay (mobile mode) */
.c-sidebar-backdrop {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: lch(from var(--col-on) l c h / 0.5);
	backdrop-filter: blur(2px);
	z-index: 99;
	opacity: 0;
	pointer-events: none;
	transition: opacity 0.3s ease-in-out;

	&.show {
		opacity: 1;
		pointer-events: auto;
	}
}

/* Collapse toggle button */
.c-sidebar-toggle {
	position: absolute;
	top: 1rem;
	background: var(--col-surface);
	border: var(--border-w-lg) solid var(--col-outline);
	border-radius: 50%;
	width: 2rem;
	height: 2rem;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	z-index: 101;
	transition: transform 0.2s;

	.c-sidebar.left & {
		right: -1rem;
	}

	.c-sidebar.right & {
		left: -1rem;
	}

	&:hover {
		background: var(--col-container);
	}

	/* Rotate icon when sidebar is closed */
	.c-sidebar:not(.open) & {
		transform: rotate(180deg);
	}
}

/* Responsive behavior */
@media (max-width: 767px) {
	/* Mobile: always overlay mode */
	.c-sidebar {
		position: fixed;

		&.pinned {
			position: fixed;
			transform: translateX(calc(-1 * var(--sidebar-width)));

			&.open {
				transform: translateX(0);
			}
		}

		&.right.pinned {
			transform: translateX(var(--sidebar-width));

			&.open {
				transform: translateX(0);
			}
		}
	}
}

@media (min-width: 768px) and (max-width: 1023px) {
	/* Tablet: can be overlay or pinned */
	.c-sidebar {
		/* Default overlay behavior */
	}
}

@media (min-width: 1024px) {
	/* Desktop: prefer pinned mode */
	.c-sidebar.auto-pin {
		transform: translateX(0);
	}
}

/* Sidebar header/footer sections */
.c-sidebar-header,
.c-sidebar-footer {
	padding: var(--p-panel);
	border-bottom: var(--border-w-lg) solid var(--col-outline);
	flex-shrink: 0;
}

.c-sidebar-footer {
	border-bottom: none;
	border-top: var(--border-w-lg) solid var(--col-outline);
}

/* Sidebar navigation items */
.c-sidebar-nav {
	list-style: none;
	padding: 0;
	margin: 0;

	& .c-nav-item {
		width: 100%;
		text-align: left;
		margin-bottom: 0.25rem;
	}
}

/* Nested sidebar sections */
.c-sidebar-section {
	margin-bottom: 1.5rem;

	&:last-child {
		margin-bottom: 0;
	}
}

.c-sidebar-section-title {
	font-size: 0.75rem;
	font-weight: 600;
	text-transform: uppercase;
	letter-spacing: 0.05em;
	color: lch(from var(--col-on) l c h / var(--op-disabled));
	padding: 0.5rem 0;
	margin: 0;
}

/* Collapsed state (icon-only mode) */
.c-sidebar.collapsed {
	--sidebar-width: 4rem;
	--sidebar-min-width: 4rem;

	& .c-sidebar-content {
		padding: 0.5rem;
	}

	& .c-sidebar-section-title,
	& .c-nav-item-text {
		opacity: 0;
		overflow: hidden;
		white-space: nowrap;
	}

	& .c-nav-item {
		justify-content: center;
	}
}

/* vim: ts=4
 */
